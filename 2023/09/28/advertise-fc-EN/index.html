<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>ZHANG QI-ZHOU（张琦周）</title><meta name="author" content="Qizhou Zhang"><link rel="shortcut icon" href="/img/favicon.png"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><meta name="generator" content="Hexo 6.3.0"></head><body><header id="page_header"><div class="header_wrap"><div id="blog_name"><a class="blog_title" id="site-name" href="/">ZHANG QI-ZHOU（张琦周）</a></div><button class="menus_icon"><div class="navicon"></div></button><ul class="menus_items"><li class="menus_item"><a class="site-page" href="/2023/09/20/pub/index.html"> Publications</a></li><li class="menus_item"><a class="site-page" href="/2023/09/20/sop/index.html"> PS</a></li></ul></div></header><main id="page_main"><div class="side-card sticky"><div class="card-wrap" itemscope itemtype="http://schema.org/Person"><div class="author-avatar"><img class="avatar-img" src="/img/head.jpg" onerror="this.onerror=null;this.src='/img/profile.png'" alt="avatar"></div><div class="author-discrip"><h3>Qizhou Zhang</h3><p class="author-bio">He is a software engineer at a AI infra startup</p></div><div class="author-links"><button class="btn m-social-links">Links</button><ul class="social-icons"><li><a class="social-icon" href="www.linkedin.com/in/qizhou-zhang-19933618b" target="_blank"><i class="fab fa-linkedin" aria-hidden="true"></i></a></li></ul></div><a class="cv-links" href="/attaches/phd/cv-en.pdf" target="_blank"><i class="fas fa-file-pdf" aria-hidden="true"><span>CV</span></i></a></div></div><div class="page" itemscope itemtype="http://schema.org/CreativeWork"><h2 class="page-title"><center> FC：High-performance Deadlock-free Hybrid Optical and Electrical Data Center Architecture </center></h2><article><h2 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h2><p>Optical and electrical hybrid data centers have become a focal point in academic. Simultaneously, Google unveiled a data center architecture named “Jupiter Evolving” at the 2022 SIGCOMM conference [2], demonstrating that hybrid optical and electrical networks are not only feasible but have already been validated in practice. The network structure of this architecture can be equated to an “expander network” after “reconfiguration,” as depicted in Figure 1 and Figure 2 below:<br><img src="/attaches/fc/odc.png"/> <img src="/attaches/fc/expander.png"/></p>
<div>Figure 1: Google's Optical Electrical Data Center&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp Figure 2: Expander Network</div>

<h2 id="Related-Work"><a href="#Related-Work" class="headerlink" title="Related Work"></a>Related Work</h2><p>This research conducted by Shizhen Zhao’s team is focused on safe deployment of RDMA at scale in the hybrid optical-electrical architecture. In this setting, the deployment of RDMA encounters the following challenges:</p>
<ol>
<li>Traditional routing algorithms can lead to deadlocks: Utilizing Equal-Cost-Multi-Path (ECMP) routing in an expander network may result in “cyclic buffer dependency,” causing local network deadlocks. Additionally, K-Shortest-Path (KSP) routes may also include ECMP paths, introducing the risk of deadlocks.</li>
<li>Limitations of existing deadlock solutions: Deadlock recovery consists of two steps - deadlock detection and deadlock resolution. In terms of deadlock detection, some methods perform detection at the control plane, but the communication delay between the data plane and the control plane is substantial, hindering timely deadlock detection. Another detection method, such as ITSY [1], detects deadlocks in the data plane but necessitates programmable switch support. Regarding deadlock resolution, temporary rerouting is a common solution, but it can lead to new congestion and deadlocks. ITSY proposes data plane deadlock resolution without rerouting [1], but this approach may result in packet loss and is less effective in handling concurrent deadlocks. Designing deadlock-free routing can entirely prevent deadlocks. [3] suggests using Edge-Disjoint-Spanning-Tree (EDST) for routing, but the EDST path is often lengthy, resulting in high latency.</li>
</ol>
<p>To sum it up, existing deadlock solutions have certain limitations in terms of detection speed, recovery effectiveness, and performance.</p>
<h2 id="Design"><a href="#Design" class="headerlink" title="Design"></a>Design</h2><p>Taking into account the aforementioned challenges, the team introduced a network architecture known as Flattened Clos (FC) [4]. FC employs a topology-routing co-design solution to address the PFC (Packet Forwarding Control) deadlock issue. The FC design comprises three steps (see Figure 3):</p>
<ol>
<li>Logical division: Each Top-of-Rack (ToR) switch is logically divided into k virtual switches, with randomly connected adjacent virtual layers.</li>
<li>Virtual up-down path generation: The generation of virtual up-down paths for routing.</li>
<li>Graph shrinkage: Mapping virtual upstream and downstream paths to actual physical paths using graph shrinkage.<img src="/attaches/fc/fc.png"/>
<div><center>Figure 3: FC's Topology and Routing Design</center></div></li>
</ol>
<p>The throughput calculations presented in the article (see Figure 4) indicate that the FC routing scheme achieves a throughput that is 2x or more higher than that of EDST, signifying superior performance.<br><img src="/attaches/fc/eval.png"/></p>
<div><center>Figure 4: FC's Throughput Test Results</center></div>

<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>This article introduces a novel algorithm that effectively mitigates the deadlock issue arising from PFC, enabling the safe deployment of RDMA in expander networks. The experiments demonstrate that: (1) FC outperforms Clos networks in terms of performance; (2) FC offers shorter routing hops compared to EDST, reducing network latency and enhancing performance. Notably, FC’s routing algorithm does not require additional hardware support and can be implemented by leveraging the OpenFlow functionality of existing switches, significantly reducing the deployment cost of FC. Consequently, these results suggest that FC presents a promising solution for addressing the PFC deadlock challenge in expander networks, offering significant advantages in terms of network performance and cost-effectiveness.</p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><p>[1] X. Wu, et al. Detecting and resolving PFC deadlocks with ITSY entirely in the data plane. In INFOCOM, 2022.<br>[2] L. Poutievski, et al. Jupiter Evolving: Transforming Google’s data center network via optical circuit switches and software-defined networking. In SIGCOMM, 2022.<br>[3] B. Stephens, et al. Practical DCB for improved data center networks. In INFOCOM, 2014.<br>[4] Zhao, Shizhen, et al. “Flattened Clos: Designing High-Performance Deadlock-Free Expander Data Center Networks Using Graph Contraction.” 20th USENIX Symposium on Networked Systems Design and Implementation (NSDI 23). 2023.</p>
</article></div></main><div class="nav-wrap"><div class="nav"><button class="site-nav"><div class="navicon"></div></button><ul class="nav_items"><li class="nav_item"><a class="nav-page" href="/2023/09/20/pub/index.html"> Publications</a></li><li class="nav_item"><a class="nav-page" href="/2023/09/20/sop/index.html"> PS</a></li></ul></div><div class="cd-top"><i class="fa fa-arrow-up" aria-hidden="true"></i></div></div><footer id="page_footer"><div class="footer_wrap"><div class="copyright">&copy;2020 - 2025 by Qizhou Zhang</div><div class="theme-info">Powered by <a target="_blank" href="https://hexo.io" rel="nofollow noopener">Hexo</a> & <a target="_blank" href="https://github.com/PhosphorW/hexo-theme-academia" rel="nofollow noopener">Academia Theme</a></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery-pjax@latest/jquery.pjax.min.js"></script><script src="/js/main.js"></script></body></html>